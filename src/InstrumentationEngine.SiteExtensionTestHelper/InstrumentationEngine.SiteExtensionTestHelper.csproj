<?xml version="1.0" encoding="utf-8"?>
<!-- Copyright (c) Microsoft Corporation. All rights reserved.
     Licensed under the MIT License. -->
<Project>
  <Import Project="$([MSBuild]::GetDirectoryNameOfFileAbove($(MSBuildThisFileDirectory), EnlistmentRoot.marker))\build\Common.props" />
  <Import Project="$(EnlistmentRoot)\build\Packaging.props" />
  <Import Project="Sdk.props" Sdk="Microsoft.NET.Sdk" />
  <PropertyGroup>
    <GenerateAssemblyFileVersionAttribute>false</GenerateAssemblyFileVersionAttribute>
    <GenerateAssemblyInfo>false</GenerateAssemblyInfo>
    <TargetFramework>netstandard2.0</TargetFramework>
    <IncludeBuildOutput>false</IncludeBuildOutput>
    <Title>InstrumentationEngineTestHelper</Title>
    <Authors>$(PackageAuthors)</Authors>
    <Owners>$(PackageOwners)</Owners>
    <OutputType>Library</OutputType>
    <Description>Microsoft Instrumentation Engine SDK and Extension Host</Description>
    <ProjectGuid>1F780CEA-27DD-44CE-91AA-B6728D3051AB</ProjectGuid>
    <CopyBuildOutputToOutputDirectory>false</CopyBuildOutputToOutputDirectory>
    <CopyOutputSymbolsToOutputDirectory>false</CopyOutputSymbolsToOutputDirectory>
  </PropertyGroup>
  <PropertyGroup>
    <EnableDefaultItems>false</EnableDefaultItems>
  </PropertyGroup>
  <ItemGroup>
    <None Include="scmApplicationHost.xdt" />
  </ItemGroup>
  <Import Project="Sdk.targets" Sdk="Microsoft.NET.Sdk" />
  <Import Project="$(EnlistmentRoot)\build\Common.targets" />
  <PropertyGroup>
    <ZipFileName>$(Title).$(PackageVersion).zip</ZipFileName>
    <!-- Required after imports to sufficiently apply this property. -->
    <PrepareForRunDependsOn>$(PrepareForRunDependsOn);ZipFiles</PrepareForRunDependsOn>
  </PropertyGroup>
  <Target Name="ZipFiles">
    <ItemGroup>
      <!-- xdt files -->
      <ZipItem Include="scmApplicationHost.xdt">
        <Destination>$(PackageVersion)</Destination>
      </ZipItem>
    </ItemGroup>

    <ZipArchiveTask OutputPath="$(IntermediateOutputPath)\$(ZipFileName)"
                    Files="@(ZipItem)" />

    <ItemGroup>
      <FileWrites Include="$(IntermediateOutputPath)\$(ZipFileName)" />
    </ItemGroup>

    <Copy SourceFiles="$(IntermediateOutputPath)\$(ZipFileName)"
          DestinationFolder="$(OutDir)">
      <Output TaskParameter="DestinationFiles" ItemName="FileWrites" />
    </Copy>
  </Target>
</Project>
